<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1a2a6c">
    <title>æ‰“ Victor</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    
    <!-- favicon è¨­å®š -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCjrS24QtvHm31nR_0TTn5caVWbcJkXEcw",
            projectId: "hitvictorhighscore",
            appId: "1:643950387981:web:3cd0288c487f4abbe58644"
        };

        // åˆå§‹åŒ– Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // å°‡ db åŒåŸ‹å…¶ä»–éœ€è¦å˜…å‡½æ•¸è¨­ç‚ºå…¨åŸŸè®Šæ•¸
        window.db = db;
        window.doc = doc;
        window.getDoc = getDoc;
        window.setDoc = setDoc;
        window.onSnapshot = onSnapshot;
    </script>

    <script>
        if ('serviceWorker' in navigator &&
            (window.location.protocol === 'https:' || window.location.hostname === 'localhost')) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</head>
<body>
    <!-- åŠ è¼‰ç•«é¢ -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <img src="faces/normal.webp" alt="Victor" class="loading-avatar">
            <div class="loading-text">æº–å‚™ç·Šæ‰“ Victor...</div>
            <div class="loading-progress-container">
                <div class="loading-progress-bar">
                    <div id="loading-progress" class="loading-progress-fill"></div>
                </div>
                <div id="loading-percentage" class="loading-percentage">0%</div>
            </div>
        </div>
    </div>
    
    <div class="game-container">
        <div class="game-header">
            <h1>æ‰“ Victor!</h1>
            <div class="controls">
                <button id="resetBtn">é–‹å§‹</button>
            </div>
        </div>

        <div class="instructions">
            <div class="instruction-content">
                <div class="instruction-title">
                    <span class="icon">ğŸ‘Š</span> é»æ“Šæ”»æ“Š Victor!
                </div>
                <div class="instruction-details">
                    <div class="detail-item">
                        <span class="icon">â±ï¸</span> é™æ™‚20ç§’
                    </div>
                    <div class="detail-item">
                        <span class="icon">â­</span> ç‡ä¸‹ä½ å¤ å””å¤ å¿«!
                    </div>
                </div>
            </div>
        </div>

        <div class="game-stats">
            <div class="stat-board timer-board">
                <div class="stat-label timer-label">æ™‚é–“</div>
                <span id="timer" class="stat-value">20</span>
            </div>
            <div class="stat-board score-board">
                <div class="stat-label score-label">åˆ†æ•¸</div>
                <span id="score" class="stat-value">0</span>
            </div>
        </div>
        
        <!-- æ–°å¢æ’è¡Œæ¦œé¢æ¿ -->
        <div class="wooden-panel leaderboard-panel">
            <div class="leaderboard-title">
                <span class="icon">ğŸ‘‘</span> æ’è¡Œæ¦œ
            </div>
            <div class="leaderboard-list" id="leaderboardList">
                <!-- æ’è¡Œæ¦œé …ç›®æœƒå‹•æ…‹æ’å…¥é€™è£¡ -->
            </div>
        </div>
        
        <!-- æ–°å¢åå­—è¼¸å…¥å°è©±æ¡† -->
        <div id="nameInputModal" class="modal hidden">
            <div class="modal-content wooden-panel">
                <h2>æ­å–œä½ é€²å…¥æ’è¡Œæ¦œï¼</h2>
                <p>è«‹è¼¸å…¥ä½ çš„åå­—ï¼š</p>
                <input type="text" id="playerNameInput" maxlength="10" placeholder="æœ€å¤š10å€‹å­—" class="wooden-input">
                <button id="submitNameBtn" class="wooden-button">ç¢ºå®š</button>
            </div>
        </div>

        <div class="character-container">
            <div id="speech-bubble" class="speech-bubble">
                <p>æ‰“æˆ‘å‘€,å“ˆå“ˆ!</p>
            </div>
            <div id="victor" class="character">
                <!-- ä½¿ç”¨çœŸå¯¦é ­åƒ -->
                <img src="faces/normal.webp" alt="Victor Normal" class="expression normal">
                <img src="faces/surprised.webp" alt="Victor Surprised" class="expression surprised hidden">
                <img src="faces/hurt.webp" alt="Victor Hurt" class="expression hurt hidden">
                <img src="faces/sad.webp" alt="Victor Sad" class="expression sad hidden">
                <img src="faces/angry.webp" alt="Victor Angry" class="expression angry hidden">
            </div>
        </div>
    </div>
    <div class="version-number">v1.5.0</div>
    <script src="script.js"></script>
</body>
</html>
